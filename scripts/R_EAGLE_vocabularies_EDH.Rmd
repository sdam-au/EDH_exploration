---
title: "Use of Eagle vocabularies in EDH"
author: "Petra Hermankova, petra.hermankova@cas.au.dk"
date: "09/11/2020"
output:
  html_document:
    theme: united
    toc: yes
    toc_float: true
    number_sections: true
    toc_depth: 4
    df_print: paged
---



## Setup of the environment:

```{r setup, echo=TRUE, message=FALSE}
devtools::install_github("sdam-au/sdam") # loading SDAM custom package, if not working try devtools::install_github("mplex/cedhar", subdir="pkg/sdam")
#devtools::install_github("mplex/cedhar", subdir="pkg/sdam")
library(tidyverse)
library(sdam)
library(jsonlite)
library(leaflet)
```

# Loading data
1. Load the dataset, if you have Sciencedata.dk credentials

```{r, echo=FALSE}
mycred_secret<- readLines("~/mysecret.txt")
```

```{r, loading data}
resp = request("EDH_text_cleaned_2020-10-09.json", path="/sharingin/648597@au.dk/SDAM_root/SDAM_data/EDH/public", method="GET", cred=mycred_secret)
```

```{r, echo=FALSE}
remove(mycred_secret)
```


2. Make a list and tibble from the request function
```{r, transform to tibble}
list_json <- jsonlite::fromJSON(resp)
EDH_tibble <- as_tibble(list_json)
```

3. Display the first 6 records
```{r, display head}
head(EDH_tibble)
```

# Use of EAGLE vocabularies in EDH

EDH uses linked open data (LOD) from EAGLE Project vocabularies (https://www.eagle-network.eu/resources/vocabularies/) in the following five XML tags:
`Object Type`, `Keywords`, `Material`, `RS Execution`, `RS Decoration`.

The aim of this script is to analyse the usage of EAGLE vocabularies in EDH as part of the Epigraphy.info working group tasked with cleaning up the EAGLE vocabularies.

```{r, select attributes}
EDH_eagle<- EDH_tibble %>% 
  select(layout_execution, layout_execution_text, support_objecttype, support_objecttype_text, support_material, support_material_text, support_decoration, keywords_term, keywords_term_text)

EDH_eagle
```

## Object 
Support tag, tag objectType.

Example of record in XML: 
```
<support>
  <objectType ref="http://www.eagle-network.eu/voc/objtyp/lod/257">Tafel</objectType>
</support>
```
### Display the first six values for illustration
```{r, head objecttype}
EDH_eagle %>% 
  select(support_objecttype, support_objecttype_text) %>% 
  head()
```
### List of all related Eagle vocabularies and their count 
```{r}
EDH_eagle %>% 
  select(support_objecttype, support_objecttype_text) %>% 
  count(support_objecttype, sort=TRUE)
```

### Overview of the ten most common vocabularies

#### Object type 2 (ignoratur)
http://www.eagle-network.eu/voc/objtyp/lod/2.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 2) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 257 (Tafel)
http://www.eagle-network.eu/voc/objtyp/lod/257.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 257) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 29 (Altar)
http://www.eagle-network.eu/voc/objtyp/lod/29.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 29) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 250 (Stele)
http://www.eagle-network.eu/voc/objtyp/lod/250.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 250) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 140 (Instrumentum domesticum)
http://www.eagle-network.eu/voc/objtyp/lod/140.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 140) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 57 (Statue base)
http://www.eagle-network.eu/voc/objtyp/lod/57.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 57) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 189 (Block)
http://www.eagle-network.eu/voc/objtyp/lod/189.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 189) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 35 (Architekturteil)
http://www.eagle-network.eu/voc/objtyp/lod/35.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 35) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 214 (Sarkophag)
http://www.eagle-network.eu/voc/objtyp/lod/214.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 214) %>% 
  count(support_objecttype_text, sort=TRUE)
```

#### Object type 89 (Meilen-/Leugenstein)
http://www.eagle-network.eu/voc/objtyp/lod/89.html

```{r}
EDH_eagle %>% 
  filter(support_objecttype == 89) %>% 
  count(support_objecttype_text, sort=TRUE)
```


### All unique values of text input
```{r}
unique(EDH_eagle$support_objecttype_text)
```

## Inscription type
Keywords tag, term tag.

Example of record in XML: 
```
<keywords>
  <term ref="http://www.eagle-network.eu/voc/typeins/lod/92">Grabinschrift</term>
</keywords>
```

### Display the first six values for illustration
```{r}
EDH_eagle %>% 
  select(keywords_term, keywords_term_text) %>%
  head()
```

### List of all Eagle vocabularies and their count
```{r}
EDH_eagle %>% 
  select(keywords_term, keywords_term_text) %>% 
  count(keywords_term, sort=TRUE)
```

### Overview of the ten most common vocabularies
TBD

### All unique values of text input
```{r}
unique(EDH_eagle$keywords_term_text)
```



## Material
Support tag, material tag.

Example of record in XML: 
```
<support>
  <material>Marmor, geädert / farbig</material>
</support>
```
### Display the first six values for illustration
```{r}
EDH_eagle %>% 
  select(support_material, support_material_text) %>%
  head()
```

### List of all Eagle vocabularies and their count 
```{r}
EDH_eagle %>% 
  select(support_material, support_material_text) %>% 
  count(support_material, sort=TRUE)
```

### Overview of the ten most common vocabularies
#### Material 138 (ignoratur)
https://www.eagle-network.eu/voc/material/lod/138.html

```{r}
EDH_eagle %>% 
  filter(support_material == 138) %>% 
  count(support_material_text, sort=TRUE)
```

#### Material 60	(Kalkstein)
https://www.eagle-network.eu/voc/material/lod/60.html

```{r}
EDH_eagle %>% 
  filter(support_material == 60) %>% 
  count(support_material_text, sort=TRUE)
```

#### Material 75 (Sandstein)
https://www.eagle-network.eu/voc/material/lod/75.html

```{r}
EDH_eagle %>% 
  filter(support_material == 75) %>% 
  count(support_material_text, sort=TRUE)
```

#### Material 48	(Marmor)		
https://www.eagle-network.eu/voc/material/lod/48.html

```{r}
EDH_eagle %>% 
  filter(support_material == 48) %>% 
  count(support_material_text, sort=TRUE)
```

#### Material 131 (Arcilla)			
https://www.eagle-network.eu/voc/material/lod/131.html

```{r}
EDH_eagle %>% 
  filter(support_material == 131) %>% 
  count(support_material_text, sort=TRUE)
```

#### Material missing Eagle LOD, text present
Example: ```<material>Marmor, geädert / farbig</material>```

```{r}
EDH_eagle %>% 
  select(support_material, support_material_text) %>% 
  filter(support_material == "") %>% 
  count(support_material_text, sort=TRUE)
```


#### Material 109 (Aes)	
https://www.eagle-network.eu/voc/material/lod/109.html

```{r}
EDH_eagle %>% 
  filter(support_material == 109) %>% 
  count(support_material_text, sort=TRUE)
```

#### Material 108 (Plumbum)		
https://www.eagle-network.eu/voc/material/lod/108.html

```{r}
EDH_eagle %>% 
  filter(support_material == 108) %>% 
  count(support_material_text, sort=TRUE)
```

#### Material 123 (Lignum)		
https://www.eagle-network.eu/voc/material/lod/123.html

```{r}
EDH_eagle %>% 
  filter(support_material == 123) %>% 
  count(support_material_text, sort=TRUE)
```

#### Material 115 (Argentum)
https://www.eagle-network.eu/voc/material/lod/115.html

```{r}
EDH_eagle %>% 
  filter(support_material == 115) %>% 
  count(support_material_text, sort=TRUE)
```






















### All unique values of text input
```{r}
unique(EDH_eagle$support_material_text)
```

## Writing
Layout tag, type execution.

Example of record in XML: 
```
<layout>
  <rs type="execution" ref="http://www.eagle-network.eu/voc/writing/lod/21">unbestimmt</rs>
</layout>
```
### Display the first six values for illustration
```{r}
EDH_eagle %>% 
  select(layout_execution, layout_execution_text) %>%
  head()
```
### List of all Eagle vocabularies and their count 
```{r}
EDH_eagle %>% 
  select(layout_execution, layout_execution_text) %>% 
  count(layout_execution, sort=TRUE)
```

### Overview of the ten most common vocabularies
#### Layout execution 21 (Ignoratur)
https://www.eagle-network.eu/voc/writing/lod/21.html

```{r}
EDH_eagle %>% 
  filter(layout_execution == 21) %>% 
  count(layout_execution_text, sort=TRUE)
```

#### Layout execution 88 (Geritzt)
https://www.eagle-network.eu/voc/writing/lod/88.html

```{r}
EDH_eagle %>% 
  filter(layout_execution == 88) %>% 
  count(layout_execution_text, sort=TRUE)
```

#### Layout execution 77 (gestempelt)
https://www.eagle-network.eu/voc/writing/lod/77.html

```{r}
EDH_eagle %>% 
  filter(layout_execution == 77) %>% 
  count(layout_execution_text, sort=TRUE)
```

#### Layout execution empty tag, but text present

```{r}
EDH_eagle %>% 
  filter(layout_execution == "") %>% 
  count(layout_execution_text, sort=TRUE)
```

#### Layout execution 96 (Gemalt / Dipinto)
https://www.eagle-network.eu/voc/writing/lod/96.html

```{r}
EDH_eagle %>% 
  filter(layout_execution == 96) %>% 
  count(layout_execution_text, sort=TRUE)
```

#### Layout execution 145 (gepunzt)
https://www.eagle-network.eu/voc/writing/lod/145.html

```{r}
EDH_eagle %>% 
  filter(layout_execution == 145) %>% 
  count(layout_execution_text, sort=TRUE)
```

#### Layout execution NA (tag completely missing in XML)
```{r}
EDH_eagle %>% 
  select(layout_execution, layout_execution_text) %>% 
  filter(is.na(layout_execution)) %>% 
  count(layout_execution_text, sort=TRUE)
```

#### Layout execution 23 (eingraviert)
https://www.eagle-network.eu/voc/writing/lod/23.html

```{r}
EDH_eagle %>% 
  filter(layout_execution == 23) %>% 
  count(layout_execution_text, sort=TRUE)
```

#### Layout execution 152 (mozaik)
https://www.eagle-network.eu/voc/writing/lod/152.html

```{r}
EDH_eagle %>% 
  filter(layout_execution == 152) %>% 
  count(layout_execution_text, sort=TRUE)
```

### All unique values of text input
```{r}
unique(EDH_eagle$layout_execution_text)
```

## Decoration 
Support, Rs tag, type decoration.

Example of record in XML:
```
<rs type="decoration" ref="http://www.eagle-network.eu/voc/decor/lod/1000">nein</rs>
```
https://www.eagle-network.eu/voc/decor/lod/1000.html = nein
https://www.eagle-network.eu/voc/decor/lod/2000.html, 2000 = ja, 
NA = missing information.

### List of all Eagle vocabularies and their count 
```{r}
EDH_eagle %>% 
  count(support_decoration, sort=TRUE)
```
